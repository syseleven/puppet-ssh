# Class: ssh::params
#
class ssh::params () {

  $listen_port = 22
  $address_family = 'inet'
  $confd = '/etc/ssh'
  $global_known_hosts = '/etc/ssh/ssh_known_hosts'

  if $::is_virtual {
    $server_rootallowed = false
    $server_passwordallowed = false
    $server_host_keys = [ '/etc/ssh/ssh_host_rsa_key', '/etc/ssh/ssh_host_ecdsa_key', '/etc/ssh/ssh_host_ed25519_key', ]
  } else {
    $server_rootallowed = true
    $server_passwordallowed = false
    $server_host_keys = [ '/etc/ssh/ssh_host_dsa_key' ]
  }

  case $::operatingsystem {
    'Gentoo': {
      $package = 'net-misc/openssh'
      $service = 'sshd'
      $pid = "/var/run/${service}.pid"
      $subsystem_sftp = '/usr/lib/misc/sftp-server'
    }
    'CentOS': {
      $package = 'openssh-server'
      $service = 'sshd'
      $pid = "/var/run/${service}.pid"
      $subsystem_sftp = '/usr/libexec/openssh/sftp-server'
    }
    'Debian', 'Ubuntu': {
      $package = 'openssh-server'
      $service = 'ssh'
      $pid = "/var/run/${service}d.pid"
      $subsystem_sftp = '/usr/lib/sftp-server'
    }
    'Solaris': {
      $subsystem_sftp = 'internal-sftp'
    }
    default: {
      fail("Unknown OS: ${::operatingsystem}")
    }
  }

  $port = $listen_port
  $global_known_hosts_file = $global_known_hosts

}

